---
title: "gather"
author: "Nikita_Lledo"
date: "10/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(ggthemes)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(leaflet)
library(htmltools)
library(maptools)
```


```{r}
d_2018 <- read.csv("raw_data/africabar_2018.csv") %>%
  mutate(year = "2018") %>%
  clean_names() %>%
  mutate(country_code = toupper(str_sub(country, 1, 3))) %>%
  
  rename(urban = urbrur) %>%
  mutate(urban = ifelse(urban == "Rural", 2, 1)) %>%
  
  rename(gender = thisint) %>%
  mutate(gender = ifelse(gender == "Female", 2, 1)) %>%
  
  rename(direction_country = q3) %>%
  mutate(direction_country = ifelse(direction_country == "Going in the right direction", 2, 1)) %>%
  
  rename(current_eco = q4a) %>%
  mutate(current_eco = case_when(current_eco == "Very good" ~ 5,
                                 current_eco == "Fairly Good" ~ 4,
                                 current_eco == "Neither good nor bad" ~ 3,
                                 current_eco == "Fairly Bad" ~ 2, 
                                 current_eco == "Very Bad" ~ 1,
                                 TRUE ~ 9)) %>%
  
  rename(current_living = q4b) %>%
  mutate(current_living = case_when(current_living == "Very good" ~ 5,
                                    current_living == "Fairly Good" ~ 4,
                                    current_living == "Neither good nor bad" ~ 3,
                                    current_living == "Fairly Bad" ~ 2, 
                                    current_living == "Very Bad" ~ 1,
                                    TRUE ~ 9)) %>%
  
  rename(comp_living = q5) %>%
  mutate(comp_living = case_when(comp_living == "Much better" ~ 5,
                                 comp_living == "Better" ~ 4,
                                 comp_living == "Same" ~ 3,
                                 comp_living == "Worse" ~ 2,
                                 comp_living == "Much worse" ~ 1,
                                 TRUE ~ 9)) %>%
  
  rename(looking_back = q6) %>%
  mutate(looking_back = case_when(looking_back == "Much better" ~ 5,
                                  looking_back == "Better" ~ 4,
                                  looking_back == "Same" ~ 3,
                                  looking_back == "Worse" ~ 2,
                                  looking_back == "Much worse" ~ 1,
                                  TRUE ~ 9)) %>%
  
  rename(looking_ahead = q7) %>%
  mutate(looking_ahead = case_when(looking_ahead == "Much better" ~ 5,
                                   looking_ahead == "Better" ~ 4,
                                   looking_ahead == "Same" ~ 3,
                                   looking_ahead == "Worse" ~ 2,
                                   looking_ahead == "Much worse" ~ 1,
                                   TRUE ~ 9)) %>%
  
  rename(pref_dem = q28) %>%
  rename(extent_dem = q35) %>%
  rename(sat_dem = q36) %>%
  rename(import_prob = q55) %>%
  rename(gov_handle = q56) %>%
  rename(trust = q43) %>%
  rename(corruption = q44) %>%
  rename(unfair = q42d) %>%
  rename(electon_fair = q23) %>%


# saveRDS(d_2018, file = "shiny/data/d_2018.rds")

# saveRDS(d_2013, file = "shiny/data/d_2013.rds")

```

```{r}
d_2013 <- read.csv("raw_data/africabar_2013.csv") %>%
  mutate(year = "2013") %>%
  clean_names() %>%
  mutate(country_code = toupper(str_sub(country, 1, 3))) %>%  
  rename(urban = urbrur) %>%
  rename(gender = thisint) %>%
  rename(current_eco = q3a) %>%
  rename(current_living = q3b) %>%
  rename(comp_living = q4) %>%
  rename(looking_back = q5a) %>%
  rename(looking_ahead = q6a) %>%
  rename(direction_country = q7) %>%
  rename(pref_dem = q32) %>%
  rename(extent_dem = q42) %>%
  rename(sat_dem = q43) %>%
  rename(import_prob = q63) %>%
  rename(gov_handle = q65) %>%
  rename(trust = q59) %>%
  rename(corruption = q60) %>%
  rename(unfair = q56b) %>%
  rename(election_fair = q28)
  


  
```

